<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mobile Dino Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        body {
            font-family: Arial, sans-serif;
            overflow: hidden;
            position: fixed;
            width: 100%;
            height: 100%;
            user-select: none;
            -webkit-user-select: none;
            transition: background-color 0.3s;
        }
        
        body.light-mode {
            background-color: #f7f7f7;
        }
        
        body.dark-mode {
            background-color: #121212;
        }
        
        #gameContainer {
            position: relative;
            width: 100%;
            height: 100vh;
            max-height: -webkit-fill-available;
            overflow: hidden;
            transition: background-color 0.3s;
        }
        
        #gameContainer.light-mode {
            background-color: white;
        }
        
        #gameContainer.dark-mode {
            background-color: #1e1e1e;
        }
        
        #gameCanvas {
            display: block;
            width: 100%;
            height: 70%;
        }
        
        #ground {
            position: absolute;
            bottom: 30%;
            width: 100%;
            height: 2px;
            transition: background-color 0.3s;
        }
        
        #ground.light-mode {
            background-color: #535353;
        }
        
        #ground.dark-mode {
            background-color: #e0e0e0;
        }
        
        #controls {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 30%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
            touch-action: manipulation;
        }
        
        #controls.light-mode {
            background-color: #f0f0f0;
        }
        
        #controls.dark-mode {
            background-color: #2d2d2d;
        }
        
        .control-btn {
            width: 120px;
            height: 120px;
            margin: 0 30px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
            transition: all 0.2s;
        }
        
        .light-mode .control-btn {
            border: 4px solid #535353;
            color: #535353;
            background-color: #e0e0e0;
        }
        
        .dark-mode .control-btn {
            border: 4px solid #e0e0e0;
            color: #e0e0e0;
            background-color: #3d3d3d;
        }
        
        .control-btn:active {
            transform: scale(0.95);
        }
        
        #jumpBtn {
            background-color: #4CAF50;
            color: white;
            border-color: #388E3C !important;
        }
        
        #duckBtn {
            background-color: #FF9800;
            color: white;
            border-color: #F57C00 !important;
        }
        
        #scoreContainer {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 24px;
            font-weight: bold;
            transition: color 0.3s;
        }
        
        .light-mode #scoreContainer {
            color: #535353;
        }
        
        .dark-mode #scoreContainer {
            color: #e0e0e0;
        }
        
        #gameOverScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 70%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            display: none;
            transition: background-color 0.3s;
        }
        
        .light-mode #gameOverScreen {
            background-color: rgba(255, 255, 255, 0.8);
        }
        
        .dark-mode #gameOverScreen {
            background-color: rgba(30, 30, 30, 0.8);
        }
        
        #gameOverText {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 20px;
            transition: color 0.3s;
        }
        
        .light-mode #gameOverText {
            color: #535353;
        }
        
        .dark-mode #gameOverText {
            color: #e0e0e0;
        }
        
        #restartBtn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .light-mode #restartBtn {
            background-color: #2196F3;
            color: white;
        }
        
        .dark-mode #restartBtn {
            background-color: #0d8aee;
            color: white;
        }
        
        #restartBtn:active {
            transform: scale(0.95);
        }
        
        #startScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 70%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            transition: background-color 0.3s;
        }
        
        .light-mode #startScreen {
            background-color: white;
        }
        
        .dark-mode #startScreen {
            background-color: #1e1e1e;
        }
        
        #startTitle {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 30px;
            transition: color 0.3s;
        }
        
        .light-mode #startTitle {
            color: #535353;
        }
        
        .dark-mode #startTitle {
            color: #e0e0e0;
        }
        
        #startBtn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .light-mode #startBtn {
            background-color: #4CAF50;
            color: white;
        }
        
        .dark-mode #startBtn {
            background-color: #3d8b40;
            color: white;
        }
        
        #startBtn:active {
            transform: scale(0.95);
        }
        
        #themeToggle {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            z-index: 20;
            transition: all 0.3s;
        }
        
        .light-mode #themeToggle {
            background-color: #535353;
            color: white;
        }
        
        .dark-mode #themeToggle {
            background-color: #e0e0e0;
            color: #121212;
        }
        
        @media (max-width: 500px) {
            .control-btn {
                width: 100px;
                height: 100px;
                margin: 0 20px;
                font-size: 20px;
            }
            
            #scoreContainer {
                font-size: 20px;
            }
            
            #gameOverText {
                font-size: 36px;
            }
            
            #themeToggle {
                width: 40px;
                height: 40px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body class="light-mode">
    <div id="gameContainer" class="light-mode">
        <canvas id="gameCanvas"></canvas>
        <div id="ground" class="light-mode"></div>
        
        <div id="themeToggle">ðŸŒ“</div>
        <div id="scoreContainer">Score: 0</div>
        
        <div id="gameOverScreen" class="light-mode">
            <div id="gameOverText">Game Over!</div>
            <button id="restartBtn">Play Again</button>
        </div>
        
        <div id="startScreen" class="light-mode">
            <div id="startTitle">Dino Game</div>
            <button id="startBtn">Start Game</button>
        </div>
        
        <div id="controls" class="light-mode">
            <div id="jumpBtn" class="control-btn">JUMP</div>
            <div id="duckBtn" class="control-btn">DUCK</div>
        </div>
    </div>

    <script>
        // Load theme preference from localStorage
        function loadTheme() {
            const savedTheme = localStorage.getItem('dinoGameTheme') || 'light-mode';
            document.body.className = savedTheme;
            document.getElementById('gameContainer').className = savedTheme;
            document.getElementById('ground').className = savedTheme;
            document.getElementById('controls').className = savedTheme;
            document.getElementById('gameOverScreen').className = savedTheme;
            document.getElementById('startScreen').className = savedTheme;
        }
        
        // Toggle between light and dark mode
        function toggleTheme() {
            const currentTheme = document.body.classList.contains('light-mode') ? 'light-mode' : 'dark-mode';
            const newTheme = currentTheme === 'light-mode' ? 'dark-mode' : 'light-mode';
            
            document.body.className = newTheme;
            document.getElementById('gameContainer').className = newTheme;
            document.getElementById('ground').className = newTheme;
            document.getElementById('controls').className = newTheme;
            document.getElementById('gameOverScreen').className = newTheme;
            document.getElementById('startScreen').className = newTheme;
            
            localStorage.setItem('dinoGameTheme', newTheme);
        }
        
        // Initialize theme
        loadTheme();
        
        // Set canvas size
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreContainer = document.getElementById('scoreContainer');
        const gameOverScreen = document.getElementById('gameOverScreen');
        const restartBtn = document.getElementById('restartBtn');
        const startScreen = document.getElementById('startScreen');
        const startBtn = document.getElementById('startBtn');
        const jumpBtn = document.getElementById('jumpBtn');
        const duckBtn = document.getElementById('duckBtn');
        const themeToggle = document.getElementById('themeToggle');
        
        function resizeCanvas() {
            const container = document.getElementById('gameContainer');
            const controlsHeight = document.getElementById('controls').offsetHeight;
            canvas.width = container.offsetWidth;
            canvas.height = container.offsetHeight - controlsHeight;
        }
        
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        // Game state
        let gameRunning = false;
        let score = 0;
        let highScore = 0;
        let gameSpeed = 5;
        let gravity = 0.6;
        let dinoY = 0;
        let dinoVelocity = 0;
        let isJumping = false;
        let isDucking = false;
        let obstacles = [];
        let clouds = [];
        let lastObstacleTime = 0;
        let lastCloudTime = 0;
        let animationId;
        let gameStartTime;
        let frameCount = 0;
        
        // Load sprites
        const dinoSprite = new Image();
        const dinoDuckSprite = new Image();
        const cactusSmallSprite = new Image();
        const cactusLargeSprite = new Image();
        const birdSprite = new Image();
        
        // Base64 encoded sprites (simplified versions of Chrome dino game assets)
        dinoSprite.src = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2MCA4MCI+PHBhdGggZmlsbD0iIzUzNTM1MyIgZD0iTTEwIDQwaDEwdjQwSDEwem0yMCAwaDEwdjQwSDMwem0xMCAxMGgxMHYzMEg0MHoiLz48L3N2Zz4=';
        dinoDuckSprite.src = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2MCA0MCI+PHBhdGggZmlsbD0iIzUzNTM1MyIgZD0iTTEwIDBoNDB2MTBIMTB6bTAgMTBoNDB2MTBIMTB6bTAgMTBoNDB2MTBIMTB6Ii8+PC9zdmc+';
        cactusSmallSprite.src = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMCA2MCI+PHBhdGggZmlsbD0iIzUzNTM1MyIgZD0iTTEwIDBoMTB2NjBIMTB6Ii8+PC9zdmc+';
        cactusLargeSprite.src = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MCA1MCI+PHBhdGggZmlsbD0iIzUzNTM1MyIgZD0iTTEwIDBoMTB2NTBIMTB6bTIwIDBoMTB2NTBIMzB6Ii8+PC9zdmc+';
        birdSprite.src = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA4MCAyMCI+PHBhdGggZmlsbD0iIzUzNTM1MyIgZD0iTTAgMTBoNDBsNDAgMTBINDB6Ii8+PC9zdmc+';
        
        // Dino properties
        const dino = {
            x: 50,
            y: 0,
            width: 60,
            height: 80,
            duckHeight: 40,
            sprite: dinoSprite,
            duckSprite: dinoDuckSprite
        };
        
        // Initialize dino position
        dino.y = canvas.height - dino.height - 2;
        
        // Obstacle types with sprites
        const obstacleTypes = [
            { width: 30, height: 60, sprite: cactusSmallSprite }, // Cactus small
            { width: 50, height: 50, sprite: cactusLargeSprite }, // Cactus large
            { width: 80, height: 20, sprite: birdSprite }        // Bird
        ];
        
        // Game functions
        function startGame() {
            gameRunning = true;
            score = 0;
            gameSpeed = 5;
            dinoY = 0;
            dinoVelocity = 0;
            isJumping = false;
            isDucking = false;
            obstacles = [];
            clouds = [];
            lastObstacleTime = 0;
            lastCloudTime = 0;
            frameCount = 0;
            gameStartTime = Date.now();
            startScreen.style.display = 'none';
            gameOverScreen.style.display = 'none';
            updateScore();
            gameLoop();
        }
        
        function endGame() {
            gameRunning = false;
            cancelAnimationFrame(animationId);
            gameOverScreen.style.display = 'flex';
            if (score > highScore) {
                highScore = score;
                // Could save high score to localStorage here if desired
            }
        }
        
        function updateScore() {
            const elapsedTime = Math.floor((Date.now() - gameStartTime) / 100);
            score = elapsedTime;
            scoreContainer.textContent = `Score: ${score}`;
        }
        
        function jump() {
            if (!isJumping && gameRunning) {
                isJumping = true;
                dinoVelocity = -15;
            }
        }
        
        function duck() {
            if (gameRunning && !isJumping) {
                isDucking = true;
            }
        }
        
        function stopDuck() {
            isDucking = false;
        }
        
        function createObstacle() {
            const now = Date.now();
            if (now - lastObstacleTime > 1500 + Math.random() * 2000) {
                const type = Math.floor(Math.random() * obstacleTypes.length);
                const obstacle = {
                    ...obstacleTypes[type],
                    x: canvas.width,
                    y: canvas.height - obstacleTypes[type].height - 2
                };
                
                // For birds, position them higher
                if (type === 2) {
                    obstacle.y = canvas.height - obstacle.height - 50;
                }
                
                obstacles.push(obstacle);
                lastObstacleTime = now;
            }
        }
        
        function createCloud() {
            const now = Date.now();
            if (now - lastCloudTime > 3000 + Math.random() * 3000) {
                const size = 20 + Math.random() * 30;
                const cloud = {
                    x: canvas.width,
                    y: 50 + Math.random() * 100,
                    width: size,
                    height: size / 2,
                    speed: 1 + Math.random() * 2
                };
                clouds.push(cloud);
                lastCloudTime = now;
            }
        }
        
        function updateGame() {
            // Update dino position
            if (isJumping) {
                dino.y += dinoVelocity;
                dinoVelocity += gravity;
                
                // Check if dino landed
                if (dino.y >= canvas.height - dino.height - 2) {
                    dino.y = canvas.height - dino.height - 2;
                    isJumping = false;
                    dinoVelocity = 0;
                }
            }
            
            // Update obstacles
            for (let i = obstacles.length - 1; i >= 0; i--) {
                obstacles[i].x -= gameSpeed;
                
                // Remove obstacles that are off screen
                if (obstacles[i].x + obstacles[i].width < 0) {
                    obstacles.splice(i, 1);
                }
            }
            
            // Update clouds
            for (let i = clouds.length - 1; i >= 0; i--) {
                clouds[i].x -= clouds[i].speed;
                
                // Remove clouds that are off screen
                if (clouds[i].x + clouds[i].width < 0) {
                    clouds.splice(i, 1);
                }
            }
            
            // Increase game speed over time
            gameSpeed = 5 + Math.floor(score / 100) * 0.5;
            
            // Check for collisions
            checkCollisions();
            
            frameCount++;
        }
        
        function checkCollisions() {
            const dinoRect = {
                x: dino.x,
                y: dino.y,
                width: dino.width,
                height: isDucking ? dino.duckHeight : dino.height
            };
            
            for (const obstacle of obstacles) {
                const obstacleRect = {
                    x: obstacle.x,
                    y: obstacle.y,
                    width: obstacle.width,
                    height: obstacle.height
                };
                
                if (
                    dinoRect.x < obstacleRect.x + obstacleRect.width &&
                    dinoRect.x + dinoRect.width > obstacleRect.x &&
                    dinoRect.y < obstacleRect.y + obstacleRect.height &&
                    dinoRect.y + dinoRect.height > obstacleRect.y
                ) {
                    endGame();
                    break;
                }
            }
        }
        
        function drawGame() {
            // Clear canvas
            if (document.body.classList.contains('light-mode')) {
                ctx.fillStyle = 'white';
            } else {
                ctx.fillStyle = '#1e1e1e';
            }
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw ground line
            if (document.body.classList.contains('light-mode')) {
                ctx.fillStyle = '#535353';
            } else {
                ctx.fillStyle = '#e0e0e0';
            }
            ctx.fillRect(0, canvas.height - 2, canvas.width, 2);
            
            // Draw clouds
            ctx.fillStyle = document.body.classList.contains('light-mode') ? '#C0C0C0' : '#606060';
            for (const cloud of clouds) {
                ctx.beginPath();
                ctx.ellipse(cloud.x, cloud.y, cloud.width, cloud.height, 0, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // Draw obstacles
            for (const obstacle of obstacles) {
                ctx.drawImage(obstacle.sprite, obstacle.x, obstacle.y, obstacle.width, obstacle.height);
            }
            
            // Draw dino
            if (isDucking && !isJumping) {
                // Ducking position
                ctx.drawImage(dino.duckSprite, dino.x, canvas.height - dino.duckHeight - 2, dino.width, dino.duckHeight);
            } else {
                // Standing or jumping position
                ctx.drawImage(dino.sprite, dino.x, dino.y, dino.width, dino.height);
            }
        }
        
        function gameLoop() {
            if (!gameRunning) return;
            
            updateScore();
            createObstacle();
            createCloud();
            updateGame();
            drawGame();
            
            animationId = requestAnimationFrame(gameLoop);
        }
        
        // Event listeners
        startBtn.addEventListener('click', startGame);
        restartBtn.addEventListener('click', startGame);
        themeToggle.addEventListener('click', toggleTheme);
        
        jumpBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            jump();
        });
        
        jumpBtn.addEventListener('mousedown', (e) => {
            e.preventDefault();
            jump();
        });
        
        duckBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            duck();
        });
        
        duckBtn.addEventListener('mousedown', (e) => {
            e.preventDefault();
            duck();
        });
        
        duckBtn.addEventListener('touchend', (e) => {
            e.preventDefault();
            stopDuck();
        });
        
        duckBtn.addEventListener('mouseup', (e) => {
            e.preventDefault();
            stopDuck();
        });
        
        duckBtn.addEventListener('mouseleave', (e) => {
            e.preventDefault();
            stopDuck();
        });
        
        // Keyboard controls for testing
        document.addEventListener('keydown', (e) => {
            if (!gameRunning && (e.code === 'Space' || e.key === ' ')) {
                startGame();
            } else if (gameRunning) {
                if (e.code === 'Space' || e.key === ' ' || e.key === 'ArrowUp') {
                    jump();
                } else if (e.key === 'ArrowDown') {
                    duck();
                }
            }
        });
        
        document.addEventListener('keyup', (e) => {
            if (e.key === 'ArrowDown') {
                stopDuck();
            }
        });
    </script>
</body>
</html>
